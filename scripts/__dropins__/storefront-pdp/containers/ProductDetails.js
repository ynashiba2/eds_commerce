import{jsxs as F,jsx as r,Fragment as Ae}from"@dropins/tools/preact-jsx-runtime.js";import*as fe from"@dropins/tools/preact-compat.js";import{useState as K,Children as ue,useRef as Le,useMemo as Ne,useEffect as ee,useCallback as ce}from"@dropins/tools/preact-compat.js";import{debounce as xe,classes as B,VComponent as Y,toLanguageTag as Me,Slot as J}from"@dropins/tools/lib.js";import{Button as we,Icon as Se,Price as ge,Picker as qe,ColorSwatch as je,ImageSwatch as Xe,TextSwatch as Fe,Incrementer as Ge,Breadcrumbs as De,Image as Oe}from"@dropins/tools/components.js";import{useText as Z}from"@dropins/tools/i18n.js";import{cloneElement as Ye}from"@dropins/tools/preact.js";import{c as Te,d as Be}from"../chunks/getRefinedProduct.js";import{events as ke}from"@dropins/tools/event-bus.js";import{c as We}from"../chunks/initialize.js";import"@dropins/tools/fetch-graphql.js";const Ke=t=>fe.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},fe.createElement("path",{d:"M7.74512 9.87701L12.0001 14.132L16.2551 9.87701",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"square",strokeLinejoin:"round"})),Ve=t=>fe.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},fe.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M18.3599 5.64001L5.62988 18.37",stroke:"currentColor"}),fe.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M18.3599 18.37L5.62988 5.64001",stroke:"currentColor"})),Ze=24,Ee=16,ve=2,Qe="32";var ze=(t=>(t[t.small=16]="small",t[t.medium=24]="medium",t[t.large=64]="large",t))(ze||{});const ye=({show:t=1,scrollbar:o=!1,peak:u=!1,arrows:p=!1,controls:s="dots",arrowsOnMainImage:f=!1,loop:d=!1,gap:v=null,direction:l="horizontal",width:G="100%",height:c="100%",defaultIndex:m=0,className:W,children:$,thumbnails:j=null,isZoomed:ne,...b})=>{const P=Z("PDP.Carousel.label").label,n=Z("PDP.Carousel.Slide.label").label,y=Z("PDP.Carousel.Previous.label").label,E=Z("PDP.Carousel.Next.label").label,I=Z("PDP.Carousel.Controls.label").label,A=Z("PDP.Carousel.Controls.Button.label").label,[N,me]=K(()=>$e(t)),e=Math.ceil(ue.count($)/N),M=u?Ze:0,D=v?ze[v]:0,q=ue.count($)%N,[L,te]=K(d?C()?m-1:m+1:m),x=Le([]),[re,oe]=K(0),[ie,be]=K(0),_e=Ne(()=>ue.toArray(j),[j]),T=Ne(()=>{const a=ue.toArray($).reduce((h,k,S)=>S%N===0?[...h,[k]]:[...h.slice(0,-1),[...h[h.length-1],k]],[]);return!d||a.length===1?a:d&&ue.count($)%N===0?[a[e-1]].concat(a).concat([a[0],a[1]]):[ue.toArray($).slice(-N)].concat(a).concat([a[0],a[1]])},[$,N,e,d]),le=Le(null),se=Le(null),g=s==="thumbnailsRow"||s==="thumbnailsColumn";ee(()=>{const a=document.body,h=xe(()=>{var O,ae;oe(((O=le.current)==null?void 0:O.offsetWidth)??0),be(((ae=le.current)==null?void 0:ae.offsetHeight)??0);const S=window.innerWidth,z=$e(t,S);z!==N&&me(z)},50),k=new ResizeObserver(h);return k.observe(a),()=>{k.unobserve(a)}},[N,t]);const Q=ce(a=>{const h=d?a-1:a,k=x==null?void 0:x.current[0],S=(k==null?void 0:k.offsetWidth)+Ee,z=(k==null?void 0:k.offsetHeight)+Ee,O=se.current,ae=s==="thumbnailsRow",Pe=s==="thumbnailsColumn",he=ae?O==null?void 0:O.offsetWidth:O==null?void 0:O.offsetHeight,X=ae?S:z;(ae||Pe)&&he&&(X*(h+1)>he&&(O.style.scrollBehavior="smooth",ae?O.scrollLeft=C()?O.scrollWidth-O.clientWidth-(h+ve)*X:(h+ve)*X:O.scrollTop=(h+ve)*X),(C()&&(ae?O.scrollLeft:O.scrollTop)<=-X*h||!C()&&(ae?O.scrollLeft:O.scrollTop)>X*h)&&(O.style.scrollBehavior="smooth",ae?O.scrollLeft=C()?-(h-ve)*X:(h-ve)*X:O.scrollTop=(h-ve)*X))},[s,d]);ee(()=>{Q(L)},[L,Q]);const U=ce((a,h,k)=>{g&&Q(a);const S=le.current,z=M?S.offsetWidth-M:S.offsetWidth-M+D;if(!Array.from(S.querySelectorAll("[data-index]")).filter(he=>{const X=Number(he.getAttribute("data-index"));return!isNaN(X)&&X>-1})[a])return;if(k){const he=a===0?e:0,X=z*(e+(q||N)/N);if(C()){if(S.scrollLeft<=0&&S.scrollLeft>-(z-5)){U(1,!0);return}if(S.scrollLeft<z-X&&S.scrollLeft>=-X){U(e,!0);return}S.style.scrollBehavior="auto",S.scrollLeft=he===0?0:-X,U(he===0?1:e,!0)}else{if(S.scrollLeft>=0&&S.scrollLeft<z-5){U(1,!0);return}if(S.scrollLeft>X-z&&S.scrollLeft<=X){U(e,!0);return}S.style.scrollBehavior="auto",S.scrollLeft=he===0?0:X,U(he===0?1:e,!0);return}}const Pe=(S.offsetWidth-D)/N*T[a].length-M;S.style.scrollBehavior=h?"smooth":"auto",S.scrollLeft=C()?-(T[a].length===N?z*a:z*(a-1)-Pe):T[a].length===N?z*a:z*(a-1)+Pe},[D,e,M,N,q,T,Q,s]),pe=ce(()=>{if(d){const h=L-1;U(h,!0,C()?L===e-1:L===1);return}const a=L<=0?0:L-1;U(a,!0)},[L,U,d]),i=ce(()=>{const a=T.length-1;if(d){const k=L+1;U(k,!0,C()?L===0:L===e);return}const h=L>=a?a:L+1;U(h,!0)},[T.length,d,L,U,e]);ee(()=>{const a=h=>{h.key==="ArrowLeft"&&(h.preventDefault(),C()?i():pe()),h.key==="ArrowRight"&&(h.preventDefault(),C()?pe():i())};return window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}},[i,pe]),ee(()=>{U(d?m+1:m,!1)},[m,U,d]);const _=xe(()=>{const a=le.current,h=M?a.offsetWidth-M:a.offsetWidth-M+D,k=Math.abs(a.scrollLeft)/h,S=Math.abs(Math.round(k)-k<1?Math.round(k):Math.ceil(k));if(g&&Q(S),d){const z=h*(e+(q||N)/N),O=C()?-a.scrollLeft:a.scrollLeft;if(Math.ceil(Math.abs(O))>=Math.ceil(z)-5){a.style.scrollBehavior="auto",a.scrollLeft=C()?-a.offsetWidth+(Math.ceil(O)-Math.ceil(z)-M):a.offsetWidth+(Math.ceil(O)-Math.ceil(z)-M);return}if(Math.abs(O)===0){a.style.scrollBehavior="auto",a.scrollLeft=C()?-(z-a.offsetWidth+M):z-a.offsetWidth+M;return}}L!==S&&te(S)},100);ee(()=>{const a=le.current;return a==null||a.addEventListener("scroll",_),()=>{a==null||a.removeEventListener("scroll",_)}},[_]);const w=(a,h,k)=>r(we,{className:B([["pdp-carousel__button",!a],[`pdp-carousel__button--${h}`,!a],[`pdp-carousel__button--${s}`,a]]),style:{"--height":`${ie}px`},variant:"tertiary","aria-label":h==="next"?E:y,onClick:k,disabled:d?!1:h==="next"?L>=T.length-1:L<1,children:r(Se,{className:B([["pdp-carousel__button__icon",!a],[`pdp-carousel__button__icon--${h}`,!a],[`pdp-carousel__button__icon--${s}--${h}`,a]]),size:Qe,source:Ke})}),V=p&&T.length!=1&&w(g,"prev",pe),H=p&&T.length!=1&&w(g,"next",i),R=p&&T.length!=1&&w(!1,"prev",pe),de=p&&T.length!=1&&w(!1,"next",i);return F("div",{role:"region","aria-roledescription":P,className:B(["pdp-carousel",["pdp-carousel--main-image-controls",f],["pdp-carousel--arrows",p&&!g],[`pdp-carousel--${s}`,g],W]),style:{"--flex-carousel":s==="thumbnailsColumn"?"row-reverse":"column","--gap":g?"0":"var(--spacing-small)","--width":G},...b,children:[r("div",{ref:le,className:B(["pdp-carousel__wrapper",`pdp-carousel__wrapper--${l}`,["pdp-carousel__wrapper--scrollbar",o],["pdp-carousel__wrapper--peak",u]]),style:{"--total-width":s==="thumbnailsColumn"?"81.6%":"100%","--height":s==="thumbnailsColumn"?"auto":c,"--gap":v?`var(--spacing-${v})`:"0px","--per-page":N},tabIndex:0,children:T.map((a,h)=>{const k=a.length<N;return r("div",{role:"group","aria-roledescription":n,"data-index":h,className:B(["pdp-carousel__slide",`pdp-carousel__slide--${l}`,["pdp-carousel__slide--active",L===h],["pdp-carousel__slide--orphan",k]]),style:{"--length":a.length},children:a},h)})}),!g&&F(Ae,{children:[V,H]}),g&&f&&F(Ae,{children:[R,de]}),s&&T.length!=1&&F("div",{className:B([[`pdp-carousel__controls__container--${s}`,g],["pdp-carousel__controls__container--no-arrows",!p||f]]),style:{"--width":s==="thumbnailsRow"?`${re}px`:G,"--height":`${ie}px`,"--nr-thumbnails":_e.length},children:[(g||ne)&&!f&&V,r("div",{ref:se,className:B([[`pdp-carousel__controls__wrapper--${s}`,g],["pdp-carousel__controls__wrapper",g]]),children:r("div",{role:"group","aria-label":I,className:B(["pdp-carousel__controls",[`pdp-carousel__controls--${s}`,g]]),children:(d?T.slice(0,e):T).map((a,h)=>{const k=d?e:T.length,S=d?L-1===h:L===h;return g?F("label",{className:B(["pdp-carousel__thumbnail__container"]),ref:z=>{z&&(x.current[h]=z)},children:[r("input",{type:"radio",name:"carousel-thumbnails","aria-label":A.replace("{key}",String(h+1)).replace("{total}",String(k)),checked:S&&re!==0,onChange:()=>{U(d?h+1:h,!0)},...b,className:B(["pdp-carousel__thumbnail",["pdp-carousel__thumbnail--selected",S&&re!==0]])}),r("span",{className:B(["pdp-carousel__thumbnail__span"]),children:_e[h]})]},h):r("button",{"aria-label":A.replace("{key}",String(h+1)).replace("{total}",String(k)),onClick:()=>{U(d?h+1:h,!0)},className:B(["pdp-carousel__controls__button",["pdp-carousel__controls__button--active",S]])},h)})})}),(g||ne)&&!f&&H]})]})};function $e(t,o=0){if(typeof t=="number")return t;const{small:u,medium:p,large:s}=t,d=[{breakpoint:1024,value:s},{breakpoint:786,value:p},{breakpoint:0,value:u}].find(({breakpoint:v})=>o>v);return d?d.value:u}function C(){return document.documentElement.dir==="rtl"}const Je=({title:t,breadcrumbs:o,galleryContent:u,infoContent:p,productContent:s,sku:f,outOfStock:d,shortDescription:v,description:l,attributes:G,images:c,options:m,price:W,specialPrice:$,className:j,children:ne,quantity:b,actions:P,carouselConfig:n,zoomType:y="overlay",closeButton:E=!0,...I})=>{var te,x,re,oe,ie,be,_e,T,le;const A=Z("PDP.Product.RegularPrice.label").label,N=Z("PDP.Product.SpecialPrice.label").label,me=Z("PDP.Product.OutOfStock.label").label,e=Z("PDP.Product.Image.label").label,[M,D]=K(null),q=c!=null&&c.length?c.map((se,g)=>{var U;const Q=((U=t==null?void 0:t.props)==null?void 0:U.children)&&(e==null?void 0:e.replace("{product}",t.props.children.toString()).replace("{key}",String(g+1)).replace("{total}",String(c.length)));return y==="zoom"?r(at,{closeButton:E,children:r(Y,{node:se,loading:g===0?"eager":"lazy",alt:Q},g)}):r(Y,{node:se,loading:g===0?"eager":"lazy",alt:Q,onClick:()=>D(g)},g)}):r("img",{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",className:"pdp-product__images__placeholder","aria-hidden":!0}),L=(te=n==null?void 0:n.thumbnails)!=null&&te.length?n.thumbnails.map((se,g)=>{var Q;return r(Y,{node:se,loading:(n==null?void 0:n.thumbnailsLoadingMode)||"lazy",alt:((Q=t==null?void 0:t.props)==null?void 0:Q.children)&&(e==null?void 0:e.replace("{product}",t.props.children.toString()).replace("{key}",String(g+1)).replace("{total}",String(c.length)))},g)}):r("img",{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",className:"pdp-product__images__placeholder","aria-hidden":!0});return F("div",{...I,className:B(["pdp-product",j]),children:[o&&r(Y,{node:o,className:"pdp-product__breadcrumbs"}),F("div",{className:"pdp-product__column-container pdp-product__gallery-column",children:[r("div",{className:"pdp-product__column-body",children:(x=n==null?void 0:n.controls)!=null&&x.desktop?r(ye,{className:"pdp-product__overlay__carousel",arrows:(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?n.controls.desktop:"dots",arrowsOnMainImage:n==null?void 0:n.arrowsOnMainImage,loop:(n==null?void 0:n.loopable)&&(c==null?void 0:c.length)>1,peak:((re=n==null?void 0:n.thumbnails)==null?void 0:re.length)>1&&((oe=n==null?void 0:n.peak)==null?void 0:oe.desktop)||!1,gap:(n==null?void 0:n.gap)||null,width:"100%",height:"100%",defaultIndex:M||0,thumbnails:L,children:q}):r(Ce,{className:"pdp-product__images",gap:"small",children:q})}),u&&r(Y,{node:u,className:"pdp-product__gallery-content"})]}),F("div",{className:"pdp-product__column-container pdp-product__content-column",children:[F("div",{className:"pdp-product__column-body",children:[F("div",{className:"pdp-product__header",children:[t&&r(Y,{node:t,className:"pdp-product__title"}),f&&r(Y,{node:f,className:"pdp-product__sku"})]}),F("div",{className:"pdp-product__prices",children:[$&&r(Y,{node:$,className:B(["pdp-product__price-special","pdp-product__price"]),"aria-label":N,role:"text"}),W&&r(Y,{node:W,className:B(["pdp-product__price-regular","pdp-product__price--grey"]),"aria-label":A,role:"text"})]}),(ie=n==null?void 0:n.controls)!=null&&ie.mobile&&((be=n==null?void 0:n.controls)==null?void 0:be.mobile)==="thumbnailsRow"?r(ye,{className:"pdp-product__images pdp-product__images--carousel pdp-product__images--carousel--thumbnails",width:"100%",height:"auto",arrows:(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?"thumbnailsRow":null,loop:(n==null?void 0:n.loopable)&&(c==null?void 0:c.length)>1,peak:((_e=n==null?void 0:n.thumbnails)==null?void 0:_e.length)>1&&((T=n==null?void 0:n.peak)==null?void 0:T.mobile)||!1,gap:(n==null?void 0:n.gap)||null,thumbnails:L,children:q}):r(ye,{className:"pdp-product__images pdp-product__images--carousel",peak:((le=n==null?void 0:n.peak)==null?void 0:le.mobile)&&(c==null?void 0:c.length)>1,gap:(n==null?void 0:n.gap)||null,width:"100%",height:"auto",arrows:(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?"dots":null,loop:(n==null?void 0:n.loopable)&&(c==null?void 0:c.length)>1,children:q}),F("div",{className:B(["pdp-product__actions",["pdp-product__actions--out-of-stock",d]]),children:[d&&r("div",{className:"pdp-product__out-of-stock__text",children:me}),m&&r(Y,{node:m,className:B(["pdp-product__options"])}),b&&r("div",{className:"pdp-product__quantity",children:r(Y,{node:b})}),P&&r(Y,{node:P,className:B(["pdp-product__buttons"])})]}),v&&r(Y,{node:v,className:B(["pdp-product__short_description"])}),l&&r(Y,{node:l,className:B(["pdp-product__description"])}),G?r("div",{className:"pdp-product__attributes",children:G}):null]}),p&&r(Y,{node:p,className:"pdp-product__info-content"})]}),s&&r(Y,{node:s,className:"pdp-product__content"}),M===null?null:r(et,{className:"pdp-product__overlay",onClose:()=>D(null),centered:!0,children:r(ye,{className:"pdp-product__overlay__carousel",arrows:(c==null?void 0:c.length)>1,width:"100%",height:"100%",defaultIndex:M||0,loop:(n==null?void 0:n.loopable)&&(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?"dots":null,isZoomed:!0,children:q})})]})},Ce=({children:t,gap:o=null,className:u,style:p,...s})=>{const f=ue.count(t);return r("div",{...s,className:B(["pdp-gallery-grid",u]),style:{"--gap":o?`var(--spacing-${o})`:"0px",...p},children:ue.map(t,(d,v)=>r("div",{className:"pdp-gallery-grid__item",children:r(Y,{node:d,loading:v===0?"eager":"lazy"},d.props.src)},f+v))})},Ie=({amount:t,currency:o,locale:u,variant:p,sale:s,minimumAmount:f,maximumAmount:d,className:v,...l})=>r(Ae,{children:t||f===d?r("div",{className:"pdp-price-range",...l,children:r(ge,{amount:t||f,currency:o,locale:u,variant:p,sale:s,className:v})}):F("div",{className:"pdp-price-range",...l,children:[r(ge,{amount:f,currency:o,locale:u,className:v}),r("span",{className:"pdp-price-range__label",children:"-"}),r(ge,{amount:d,currency:o,locale:u,className:v})]})}),et=({centered:t,onClose:o,className:u,children:p,...s})=>{const f=Z("PDP.Overlay.Close.label").label,d=ce(()=>{o==null||o()},[o]);return ee(()=>{const v=l=>{l.key==="Escape"&&d()};return document.addEventListener("keydown",v),()=>{document.removeEventListener("keydown",v)}},[d]),ee(()=>{const v=document.scrollingElement,l=v.style.overflow;return v.style.overflow="hidden",()=>{v.style.overflow=l}},[]),F("div",{...s,className:B(["pdp-overlay",["pdp-overlay--centered",t],u]),children:[r("div",{className:"pdp-overlay__content",children:p}),r(we,{"aria-label":f,variant:"tertiary",className:"pdp-overlay__close-button",onClick:d,icon:r(Ve,{})})]})},tt=["text","image","color","dropdown"],nt=t=>t.map(o=>({...o,text:o.label,disabled:!o.inStock}));function rt(t,o){return t.reduce((u,p)=>{const s=o==null?void 0:o.find(d=>d.items.find(v=>v.id===p));if(!s)return u;const f=s.items.find(d=>d.id===p);return{...u,[s.id]:{label:f.label,value:f.id}}},{})}const lt=({options:t,hideSelectedValue:o,selectedUIDs:u,onValues:p,onErrors:s,defaultOptions:f,selectionsToUpdate:d,className:v,children:l,...G})=>{const c=Z("PDP.Swatches.Required.label").label,[m,W]=K(()=>t==null?void 0:t.reduce((P,n)=>{const{items:y}=n,E=y==null?void 0:y.find(A=>f==null?void 0:f.includes(A.id)),I=y==null?void 0:y.find(A=>A.selected);return E?{...P,[n.id]:{label:E.label,value:E.id}}:I?{...P,[n.id]:{label:I.label,value:I.id}}:P},{}));ee(()=>{if(u){const b=rt(u,t);if(JSON.stringify(b)===JSON.stringify(m))return;$(Object.keys(b)[0],b[Object.keys(b)[0]].label,u[0])}},[u]),ee(()=>{d==null||d.forEach(b=>{W(P=>{var E;const n=(E=b==null?void 0:b.items)==null?void 0:E.find(I=>I.selected);return n?{...P,[b.id]:{label:n==null?void 0:n.label,value:n==null?void 0:n.id}}:P})})},[d,W]),Ne(()=>{const b=t==null?void 0:t.reduce((P,n)=>{var E;let y=!1;return(E=n==null?void 0:n.items)==null||E.forEach(I=>{var N;((N=m[n.id])==null?void 0:N.value)===I.id&&(y=!0)}),n.required&&!y&&(P[n.id]=c),P},{});return s==null||s(b),b},[m]);const $=ce((b,P,n)=>{W(y=>{const E={...y,[b]:{label:P,value:n}};return p==null||p(E,n),E})},[p]),j=(b,P)=>{var y;const n=((y=P.selectedOptions[0])==null?void 0:y.label)??"";$(b,n,P.value)},ne=ce(({items:b,id:P,required:n,type:y,selected:E,label:I})=>(b==null?void 0:b.length)>0&&r("div",{className:B(["pdp-swatches__options"]),children:(y==null?void 0:y.toLowerCase())==="dropdown"?r(qe,{"aria-label":I,handleSelect:A=>j(P,A.target),options:nt(b),value:E}):b==null?void 0:b.map(A=>{const N={key:A.id,id:A.id,name:P,value:A.value,label:A.label,groupAriaLabel:I,selected:E===A.id,outOfStock:!A.inStock,required:n===null?!0:n,onValue:()=>{$(P,A.label,A.id)}};switch(y){case"text":return r(Fe,{...N,label:A.label});case"image":return r(Xe,{...N,src:A.value,alt:A.label});case"color":return r(je,{...N,size:"large",color:A.value});default:return console.warn(`Invalid swatch type ${y}`),null}})}),[$]);return r("div",{...G,className:B(["pdp-swatches",v]),children:t==null?void 0:t.map(({type:b,label:P,id:n,multiple:y,required:E,items:I})=>{var A;return tt.includes(b)||console.warn(`Invalid swatch type ${b}`),y&&console.warn("Multiple selection swatches are not currently supported."),F("div",{id:`swatch-item-${n}`,"data-slot-key":`product-swatch--${n}`,className:"pdp-swatches__field",children:[r("div",{className:"pdp-swatches__field__label",children:m[n]?o?`${P}`:`${P}: ${m[n].label}`:P}),r(ne,{id:n,type:b,required:E,items:I,label:P,selected:(A=m[n])==null?void 0:A.value})]},`swatch-item-${n}`)})})},at=({children:t,scale:o=2,closeButton:u=!0})=>{const[p,s]=K(!1),[f,d]=K("pdp-zoom"),[v,l]=K(!1),[G,c]=K({x:0,y:0}),[m,W]=K({x:0,y:0}),[$,j]=K({x:0,y:0}),ne=e=>{!p||e.type!=="touchstart"||(c({x:e.touches[0].clientX,y:e.touches[0].clientY}),W({x:$.x,y:$.y}),l(!0))},b=e=>{var ie;if(!v||e.type!=="touchmove")return;const M=(ie=e.currentTarget)==null?void 0:ie.getBoundingClientRect(),D=(100-100/o)/2,q=e.touches[0].clientX-G.x,L=e.touches[0].clientY-G.y,te=q*100/(M.width*o),x=L*100/(M.height*o),re=m.x+te,oe=m.y+x;j({x:Math.max(-D,Math.min(re,D))||0,y:Math.max(-D,Math.min(oe,D))||0}),e.preventDefault()},P=e=>{var x;const M=(x=e.currentTarget)==null?void 0:x.getBoundingClientRect(),D=(100-100/o)/2;let q;if("touches"in e)q=e.touches[0];else if(e instanceof MouseEvent)q=e;else return;const L=D-(q.clientX-M.left)/M.width*100,te=D-(q.clientY-M.top)/M.height*100;j({x:Math.max(-D,Math.min(L,D))||0,y:Math.max(-D,Math.min(te,D))||0})},n=e=>{if(!v){if(p){if(u&&"touches"in e){ne(e);return}u||s(!1)}else s(!0),P(e);e.preventDefault()}},y=e=>{if(u&&"touches"in e){b(e);return}p&&P(e)},E=()=>{if(u){l(!1);return}s(!1)},I=e=>{s(!1),e.stopPropagation()},A=p?`scale(${o}) translateX(${$.x}%) translateY(${$.y}%)`:"none",N=Z("PDP.Zoom.Close.label").label,me=Ye(ue.only(t),{draggable:!1,style:{"--transform":A}});return ee(()=>{d(p?`pdp-zoom ${u?"pdp-zoom--no-effects":"pdp-zoom--zoomed"}`:"pdp-zoom")},[p,u]),F("figure",{className:f,onClick:n,onMouseMove:y,onMouseLeave:E,onTouchStart:n,onTouchMove:y,onTouchEnd:E,children:[me,u&&p&&r(we,{"aria-label":N,variant:"tertiary",className:"pdp-zoom__close-button",icon:r(Ve,{}),onClick:I})]})};function ct(t,o="en_US"){if(!Ue(t))throw Error("Invalid date string");return t.split(" ")[1]||(t=`${t} 00:00:00`),new Date(t).toLocaleDateString(Me(o)).toString()}function Ue(t){if(![/^\d{4}-\d{2}-\d{2}$/,/^\d{1,2}\/\d{1,2}\/\d{4}$/,/^\d{2}\/\d{2}\/\d{4}$/,/^\d{4}\/\d{2}\/\d{2}$/,/^\d{1,2}\.\d{1,2}\.\d{4}$/,/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/].some(p=>p.test(t)))return!1;const u=new Date(t);return!isNaN(u.getTime())}function ot(t){const o=new URLSearchParams(window.location.search);Object.entries(t).forEach(([p,s])=>{s===null?o.delete(p):o.set(p,String(s))});let u=window.location.pathname;u+=`?${o.toString()}`,u+=window.location.hash,window.history.replaceState({},"",u)}function it(){const t=new URLSearchParams(window.location.search),o={};return t.forEach((u,p)=>{o[p]=u}),o}function st(t){var o,u,p,s,f,d,v,l,G,c,m,W;return{productId:Number(t==null?void 0:t.externalId),name:t==null?void 0:t.name,sku:(t==null?void 0:t.variantSku)||(t==null?void 0:t.sku),topLevelSku:t==null?void 0:t.sku,specialToDate:void 0,specialFromDate:void 0,newToDate:void 0,newFromDate:void 0,createdAt:void 0,updatedAt:void 0,manufacturer:void 0,countryOfManufacture:void 0,categories:void 0,productType:void 0,pricing:{regularPrice:((u=(o=t==null?void 0:t.prices)==null?void 0:o.regular)==null?void 0:u.amount)||0,minimalPrice:(s=(p=t==null?void 0:t.prices)==null?void 0:p.final)==null?void 0:s.minimumAmount,maximalPrice:(d=(f=t==null?void 0:t.prices)==null?void 0:f.final)==null?void 0:d.maximumAmount,specialPrice:(l=(v=t==null?void 0:t.prices)==null?void 0:v.final)==null?void 0:l.amount,tierPricing:void 0,currencyCode:((c=(G=t==null?void 0:t.prices)==null?void 0:G.final)==null?void 0:c.currency)||"USD"},canonicalUrl:t==null?void 0:t.url,mainImageUrl:(W=(m=t==null?void 0:t.images)==null?void 0:m[0])==null?void 0:W.url}}const dt={PRODUCT_CONTEXT:"productContext"},ht={PRODUCT_PAGE_VIEW:"product-page-view"};function He(){return window.adobeDataLayer=window.adobeDataLayer||[],window.adobeDataLayer}function ut(t,o){const u=He();u.push({[t]:null}),u.push({[t]:o})}function pt(t,o){He().push(p=>{const s=p.getState?p.getState():{};p.push({event:t,eventInfo:{...s,...o}})})}function Re(t){const o=st(t);ut(dt.PRODUCT_CONTEXT,o),pt(ht.PRODUCT_PAGE_VIEW)}const mt=({sku:t,hideSku:o,hideQuantity:u,hideShortDescription:p,hideDescription:s,hideAttributes:f,hideURLParams:d,hideSelectedOptionValue:v,slots:l,children:G,initialData:c,carousel:m,optionsConfig:W,useACDL:$,onAddToCart:j,zoomType:ne,closeButton:b=!0,...P})=>{var g,Q,U,pe;const n=Z("PDP.Product.AddToCart.label").label,y=Z("PDP.Product.Incrementer.label").label,E=Z("PDP.Product.Details.label").label,[I,A]=K(We.getConfig().defaultLocale||"en-US"),[N,me]=K(),[e=null,M]=K(c),[D,q]=K(()=>{const i={sku:t,quantity:1};return e!=null&&e.optionUIDs&&(i.optionsUIDs=e.optionUIDs),i}),[L,te]=K(()=>{var i,_;return!(e!=null&&e.options&&((i=e==null?void 0:e.options)==null?void 0:i.length)>0&&((_=e==null?void 0:e.optionUIDs)==null?void 0:_.length)!==(e==null?void 0:e.options.length))}),x={data:e,values:D,valid:L};function re(i){return i==null?void 0:i.some(_=>(_==null?void 0:_.typename)==="ProductViewOptionValueProduct")}ee(()=>{const i=ke.on("pdp/setValues",_=>{q(w=>({...w,..._}))});return()=>{i==null||i.off()}},[]),ee(()=>{const i=ke.on("locale",_=>{_!==I&&(A(_),Te(t).then(M))});return()=>{i==null||i.off()}},[I,t]),ee(()=>{$&&c&&Object.keys(c).length>0&&Re(c)},[c]);const oe=ce(i=>{q(_=>({..._,...i}))},[]);ee(()=>{ke.emit("pdp/values",D)},[JSON.stringify(D)]);const ie=ce(i=>{var V,H;let _=Object.keys(i).map(R=>i[R].value).filter(R=>R!==void 0);!d&&(e!=null&&e.options)&&!re(e.options)&&ot({optionsUIDs:_.join(",")}),oe({optionsUIDs:_}),te((_==null?void 0:_.length)===((V=e==null?void 0:e.options)==null?void 0:V.length));const w=(H=e==null?void 0:e.options)==null?void 0:H.some(R=>re([R]));Be(t,_,W==null?void 0:W.anchorOptions,w).then(R=>{var de;M(R),(de=W==null?void 0:W.anchorOptions)!=null&&de.length&&be(R,_),$&&(R==null?void 0:R.variantSku)!==t&&Re(R)})},[t]),be=ce((i,_)=>{var H;const w=(i==null?void 0:i.optionUIDs)??[];_.every(R=>w.includes(R))||(me(i==null?void 0:i.options),oe({optionsUIDs:w}),te((w==null?void 0:w.length)===((H=i==null?void 0:i.options)==null?void 0:H.length)))},[t]),_e=ce(i=>{Object.keys(i).length!==0&&te(!1)},[]),T=Ne(()=>{var i;return(i=e==null?void 0:e.attributes)==null?void 0:i.map(({label:_,value:w},V)=>{const H=Ue(w)?ct(w,I):w.toString();return F("li",{children:[_,": ",r("span",{dangerouslySetInnerHTML:{__html:H}})]},V)})},[e==null?void 0:e.attributes,I]),le=!u&&(e!=null&&e.inStock)?r(J,{name:"Quantity",slot:l==null?void 0:l.Quantity,context:{...x},children:r(Ge,{name:"quantity",defaultValue:D.quantity.toString(),value:D.quantity.toString(),min:1,"aria-label":y,className:"pdp-product__quantity",onValue:i=>{oe({quantity:Number(i)})}},"quantity")}):void 0,se=()=>{if(e!=null&&e.options)return r(J,{name:"Options",slot:l==null?void 0:l.Options,context:{...x},children:r(lt,{selectedUIDs:D.optionsUIDs,options:e.options,defaultOptions:D.optionsUIDs,selectionsToUpdate:N,hideSelectedValue:v,onValues:ie,onErrors:_e})})};return r("div",{...P,children:r(Je,{title:r(J,{name:"Title",slot:l==null?void 0:l.Title,context:{...x},children:e==null?void 0:e.name}),sku:o?void 0:r(J,{name:"SKU",slot:l==null?void 0:l.SKU,context:{...x},children:e==null?void 0:e.sku}),options:se(),breadcrumbs:(l==null?void 0:l.Breadcrumbs)&&r(J,{name:"Breadcrumbs",slot:l==null?void 0:l.Breadcrumbs,context:{...x,setSeparator(i){this._registerMethod((..._)=>{const w=i(..._),V=w&&r(Se,{source:w});this._setProps(H=>({...H,separator:V,children:[r(De,{separator:V,categories:H.categories})]}))})},appendLink(i){this._registerMethod((..._)=>{const{text:w,...V}=i(..._),H=r("a",{...V,children:w});this._setProps(R=>{const de=[...R.categories||[],H];return{...R,categories:de,children:[r(De,{separator:R.separator,categories:de})]}})})},appendHTMLElement(i){this._registerMethod((..._)=>{const w=i(..._),V=this._htmlElementToVNode(w);this._setProps(H=>{const R=[...H.categories||[],V];return{...H,categories:R,children:[r(De,{separator:H.separator,categories:R})]}})})}}}),quantity:le,actions:r(J,{name:"Actions",slot:l==null?void 0:l.Actions,context:{...x,appendButton(i){this._registerMethod((..._)=>{const w=i(..._);if(!w)return;const{text:V,icon:H,...R}=w,de=r(we,{type:"button",...R,icon:H&&r(Se,{source:H}),children:V});this._setProps(a=>({children:[...a.children||[],de]}))})}},children:!(l!=null&&l.Actions)&&r(we,{size:"medium",type:"submit",icon:r(Se,{source:"Cart"}),disabled:!(e!=null&&e.inStock)||!L,"aria-label":n,onClick:()=>j==null?void 0:j(D),children:n})}),shortDescription:p?void 0:r(J,{name:"ShortDescription",slot:l==null?void 0:l.ShortDescription,context:{...x},children:r("div",{dangerouslySetInnerHTML:{__html:(e==null?void 0:e.shortDescription)??""}})}),description:s?void 0:r(J,{name:"Description",slot:l==null?void 0:l.Description,context:{...x},children:r("div",{dangerouslySetInnerHTML:{__html:(e==null?void 0:e.description)??""}})}),images:((g=e==null?void 0:e.images)==null?void 0:g.map(({label:i,url:_})=>{var w,V;return r(Oe,{title:i,alt:i,src:_,width:((w=m==null?void 0:m.imageParams)==null?void 0:w.width)??960,height:((V=m==null?void 0:m.imageParams)==null?void 0:V.height)??1191,params:(m==null?void 0:m.imageParams)??{width:960}},_)}))??[],specialPrice:(Q=e==null?void 0:e.prices)!=null&&Q.visible?r(J,{name:"SpecialPrice",slot:l==null?void 0:l.SpecialPrice,context:{...x},children:r(Ie,{...e.prices.final,locale:Me(I)})}):void 0,price:(U=e==null?void 0:e.prices)!=null&&U.visible&&e.prices.regular&&e.prices.final.amount!==(e==null?void 0:e.prices.regular.amount)?r(J,{name:"RegularPrice",slot:l==null?void 0:l.RegularPrice,context:{...x},children:r(Ie,{...e.prices.regular,locale:Me(I)})}):void 0,zoomType:ne,closeButton:b,carouselConfig:{...m,thumbnails:m&&Object.keys(m).length?((pe=e==null?void 0:e.images)==null?void 0:pe.map(({label:i,url:_})=>{var w,V;return r(Oe,{title:i,alt:i,src:_,width:((w=m==null?void 0:m.thumbnailParams)==null?void 0:w.width)??200,height:((V=m==null?void 0:m.thumbnailParams)==null?void 0:V.height)??248,params:(m==null?void 0:m.thumbnailParams)??{width:200}},_)}))??[]:[]},outOfStock:!(e!=null&&e.inStock),attributes:f?void 0:r(J,{name:"Attributes",slot:l==null?void 0:l.Attributes,context:{...x},children:T!=null&&T.length?F(Ae,{children:[E,r("ul",{children:T})]}):null}),galleryContent:(l==null?void 0:l.GalleryContent)&&r(J,{name:"GalleryContent",slot:l.GalleryContent,context:{...x}}),infoContent:(l==null?void 0:l.InfoContent)&&r(J,{name:"InfoContent",slot:l.InfoContent,context:{...x}}),productContent:(l==null?void 0:l.Content)&&r(J,{name:"Content",slot:l.Content,context:{...x}})})})};mt.getInitialData=async function({sku:t,optionsConfig:o}){var v,l,G,c,m,W,$;function u(j){return j.some(ne=>ne.__typename==="ProductViewOptionValueProduct")}let p;const s=We.getConfig(),f=((v=it().optionsUIDs)==null?void 0:v.split(","))||((c=(G=(l=s==null?void 0:s.models)==null?void 0:l.ProductDetails)==null?void 0:G.initialData)==null?void 0:c.optionsUIDs),d=(W=(m=s==null?void 0:s.models)==null?void 0:m.ProductDetails)==null?void 0:W.initialData;return d&&Object.keys(d).length>0&&(p=($=d.options)==null?void 0:$.some(j=>u(j==null?void 0:j.values))),f!=null&&f.length?await Be(t,f,o==null?void 0:o.anchorOptions,p):await Te(t)};export{mt as ProductDetails,mt as default};
